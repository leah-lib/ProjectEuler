#The prime 41, can be written as the sum of six consecutive primes:

#41 = 2 + 3 + 5 + 7 + 11 + 13
#This is the longest sum of consecutive primes that adds to a prime below one-hundred.

#The longest sum of consecutive primes below one-thousand that adds to a prime, contains 21 terms, and is equal to 953.

#Which prime, below one-million, can be written as the sum of the most consecutive primes?

import math
import time


print time.time()

primes = {}
primes[2] = True
i = 3

while i < 1000000:
    primes[i] = True
    i+=2
    
print time.time()

p_list = primes.keys()
for k in range(2, len(p_list)):
    for j in p_list[:k-1]:
        if p_list[k]%j == 0:
            if p_list[k] in primes.keys():
                del primes[p_list[k]]
            break




print time.time()

num = 0
longest = 0


prime_list = primes.keys()
len_p = len(prime_list)





for a in range (0, len_p-1):
    if len_p-a < longest:
        break
    if a*longest > 1000000:
        break
    b = a + longest
    sum_primes = sum(prime_list[a:b])
    while True:
        if sum_primes > 1000000:
            break
        if sum_primes in primes:
            longest = b-a
            num = sum_primes
        b+=1
        if b >= len_p:
            break
        sum_primes+=prime_list[b]


    
               
                      
print time.time()

                      
print num
print longest

    
